[app:api_versions]
paste.app_factory = freezer_api.api.versions:api_versions

[app:appv1]
paste.app_factory = freezer_api.service:freezer_appv1_factory

[app:appv2]
paste.app_factory = freezer_api.service:freezer_appv2_factory

[filter:authtoken]
paste.filter_factory = keystonemiddleware.auth_token:filter_factory

[app:healthcheck]
paste.app_factory = oslo_middleware:Healthcheck.app_factory
backends = disable_by_file
disable_by_file_path = /etc/freezer/healthcheck_disable

[filter:context]
paste.filter_factory = freezer_api.api.common.middleware:ContextMiddleware.factory

[filter:versionsNegotiator]
paste.filter_factory = freezer_api.api.versions:VersionNegotiator.factory

[filter:http_proxy_to_wsgi]
paste.filter_factory = oslo_middleware:HTTPProxyToWSGI.factory

[composite:main]
use = egg:Paste#urlmap
/healthcheck = healthcheck
/ = api

[pipeline:api]
pipeline = http_proxy_to_wsgi versionsNegotiator authtoken context backupapp

[composite:unauthenticated_freezer_api]
use = egg:Paste#urlmap
/healthcheck = healthcheck
/ = unauthenticated_api

[pipeline:unauthenticated_api]
pipeline = http_proxy_to_wsgi freezer_app

[composite:backupapp]
paste.composite_factory = freezer_api.service:root_app_factory
/: api_versions
/v1: appv1
/v2: appv2

- project:
    templates:
      - check-requirements
      - openstack-lower-constraints-jobs
      - openstack-python3-victoria-jobs
      - publish-openstack-docs-pti
      - release-notes-jobs-python3
    check:
      jobs:
        - openstack-tox-pylint
        - freezer-api-tempest
        - freezer-api-tempest-sqlalchemy
    gate:
      jobs:
        - openstack-tox-pylint
        - freezer-api-tempest
        - freezer-api-tempest-sqlalchemy

- job:
    name: freezer-api-ubuntu
    parent: legacy-dsvm-base
    run: playbooks/legacy/freezer-api-ubuntu/run.yaml
    post-run: playbooks/legacy/freezer-api-ubuntu/post.yaml
    timeout: 7800
    required-projects:
      - openstack/devstack-gate
      - openstack/freezer
      - openstack/freezer-api
      - openstack/freezer-web-ui
      - openstack/python-freezerclient
      - openstack/freezer-tempest-plugin

- job:
    name: freezer-api-centos-7-old
    parent: legacy-dsvm-base
    run: playbooks/legacy/freezer-api-centos-7/run.yaml
    post-run: playbooks/legacy/freezer-api-centos-7/post.yaml
    timeout: 7800
    nodeset: legacy-centos-7
    required-projects:
      - openstack/devstack-gate
      - openstack/freezer
      - openstack/freezer-api
      - openstack/freezer-web-ui
      - openstack/python-freezerclient
      - openstack/freezer-tempest-plugin

- job:
    name: freezer-api-opensuse-15
    parent: legacy-dsvm-base
    run: playbooks/legacy/freezer-api-opensuse-15/run.yaml
    post-run: playbooks/legacy/freezer-api-opensuse-15/post.yaml
    timeout: 7800
    nodeset: legacy-opensuse-15
    required-projects:
      - openstack/devstack-gate
      - openstack/freezer
      - openstack/freezer-api
      - openstack/freezer-web-ui
      - openstack/python-freezerclient
      - openstack/freezer-tempest-plugin


- job:
    name: freezer-api-tempest
    parent: devstack-tempest
    timeout: 7200
    required-projects:
      - openstack/devstack-gate
      - openstack/python-openstackclient
      - openstack/python-freezerclient
      - openstack/freezer
      - openstack/freezer-api
      - openstack/freezer-tempest-plugin
      - openstack/tempest
    vars:
      devstack_plugins:
        freezer-api: https://opendev.org/openstack/freezer-api
      devstack_services:
        tls-proxy: false
        freezer-api: true
        tempest: true
        s-account: false
        s-container: false
        s-object: false
        s-proxy: false
      devstack_localrc:
        TEMPEST_PLUGINS: '/opt/stack/freezer-tempest-plugin'
      tempest_test_regex: '^(freezer_tempest_plugin.tests.freezer_api)'
      tox_envlist: all
      tox_environment:
        PYTHONUNBUFFERED: 'true'
      zuul_copy_output:
        /etc/hosts: logs


- job:
    name: freezer-api-tempest-sqlalchemy
    parent: devstack-tempest
    timeout: 7200
    required-projects:
      - openstack/devstack-gate
      - openstack/python-openstackclient
      - openstack/python-freezerclient
      - openstack/freezer
      - openstack/freezer-api
      - openstack/freezer-tempest-plugin
      - openstack/tempest
    vars:
      devstack_plugins:
        freezer-api: https://opendev.org/openstack/freezer-api
      devstack_services:
        tls-proxy: false
        freezer-api: true
        tempest: true
        s-account: false
        s-container: false
        s-object: false
        s-proxy: false
      devstack_localrc:
        FREEZER_BACKEND: 'sqlalchemy'
        TEMPEST_PLUGINS: '/opt/stack/freezer-tempest-plugin'
      tempest_test_regex: '^(freezer_tempest_plugin.tests.freezer_api)'
      tox_envlist: all
      tox_environment:
        PYTHONUNBUFFERED: 'true'
      zuul_copy_output:
        /etc/hosts: logs
